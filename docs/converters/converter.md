<!--
SPDX-FileCopyrightText: 2022 Contributors to the Power Grid Model IO project <dynamic.grid.calculation@alliander.com>

SPDX-License-Identifier: MPL-2.0
-->

# Converters

There are 4 types of converters present as of now. PGM JSON Converter, VisonExcelConverter, GaiaExcelConverter and Pandapower Converter.
Among them, VisonExcelConverter and GaiaExcelConverter are [tabular converters](tabular_converter.md) for excel exports of vision and gaia respectively.

PGM JSON converter converts to and from the power-grid-model JSON data format. 
This json format makes it convenient to evaluate the grid data in perspective of input to power-grid-model. 
More details about the JSON format are mentioned in {external:py:class}`power_grid_model.utils` and example of it is in [Make Test Dataset](power-grid-model:exapmles/Make%20Test%20Dataset.ipynb) in power-grid-model repository.
Check the API reference of {py:class}`PgmJsonConverter` for more information.

Pandapower converter converts pandapower network which is a dictionary of dataframes to power-grid-model data.

A converter object can be instantiated in the following way.

```python
from power_grid_model_io.converters.pgm_json_converter import PgmJsonConverter

converter = PgmJsonConverter(source_file=source, destination_file=destination)
```


All converters have certain common methods for loading, converting and saving source data.

## Loading data

Use the methods load_input_data(), load_update_data(), load_sym_output_data(), load_asym_output_data() to load the relevant data to the converter.
The Converter can be initialised with `source_file` containing path to source data. Or alternatively, the data can be provided as an argument to the load function.

In addition to the power-grid-model input data, other miscellaneous information in the source file not used in calculations by power-grid-model gets stored under `extra_info`

```python
input_data, extra_info = converter.load_input_data(data=example_data)
```

## Saving Data

It is possible to save the data in the format of the converter.
The Converter can be instantiated with a path given to `destination_file`. 
Alternatively, the destination path can be provided in the save function.
You can also add additional information about each component in the form of `extra_info` generated by [Load data](converter.md#load-data) to be saved along with it.

```python
converter.save(example_data, extra_info=example_extra_info, destination=destination_path)
```
